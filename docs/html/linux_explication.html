
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Linux Explication &#8212; CBC Documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="CBC Linux Tutorial Presentation Slides" href="slides.html" />
   
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115983496-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115983496-2');
</script>

  
  <link rel="alternate" type="application/atom+xml"  href="blog/atom.xml" title="CBC Documentation">
  
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="linux-explication">
<h1>Linux Explication<a class="headerlink" href="#linux-explication" title="Permalink to this headline">¶</a></h1>
<p>This document constitutes a more elaborate discussion of the principles described in our Linux presentation, presented in a structure more resembling a narrative.  The code within can be copied into a terminal and directly executed (though it is currently undergoing testing and may still have bugs).</p>
<p><em>If this page is missing any basic information that you would find helpful, please contact us at cbc-help&#64;brown.edu - when doing so, please specify that your message is regarding the contents of this tutorial</em></p>
<div class="section" id="part-i-introduction-to-linux">
<h2>Part I: Introduction to Linux<a class="headerlink" href="#part-i-introduction-to-linux" title="Permalink to this headline">¶</a></h2>
<p>The original way to interact with a computer, dating back to the 1960s - so why use it in this day and age?</p>
<p>The command line offers greater flexibility compared to a graphical user interface (GUI) - many more options can be implented in a command line environment than would be feasible in the limited space of a GUI.  Furthermore, command line utilities are easy to automate using scripts, allowing for more efficient data analysis and saving you from annoying busy work.</p>
<p>At first, the bare-bones ‘retro’ appearance of the CLI is intimidating, especially since you need to memorize a few commands before it becomes usable - eventually, though, it is faster to use than a GUI for many tasks.  For example, you can switch between directories by typing their names rather than scrolling through a folder and searching for the icon you need, or move many files at once without the awkwardness of physically selecting them.</p>
<p>To understand how to use the CLI, it is important to learn a few simple commands that will let you navigate the system - memorizing these will make life much easier and more efficient.  Specifically, the commands worth learning immediately from the outset are those that involve navigating through Linux directories (i.e folders).</p>
<p><em>Directories and Navigation</em></p>
<p>These commands will be illustrated with examples from Brown’s compute cluster.  For those who are not affiliated with Brown, note that the system in question runs CentOS 6.7.</p>
<p>The first navigation command to remember is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>pwd

[aleith@login002 ~]$ pwd
/users/aleith
</pre></div>
</div>
<p>It stands for ‘print working directory’, and does exactly that - displays the file path of the directory (folder) you’re currently inside, otherwise known as the ‘working directory’.</p>
<p>The next command is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ls

[aleith@login002 ~]$ ls
4-1                      Figure2c.eps               problem set 1
5b                       finalgenerate              profile_backup
anaconda                 helloworld.Rout            qiime2-2018.2-py35-linux-conda.yml
</pre></div>
</div>
<p>It stands for ‘list’, and also does what it sounds like: lists the contents of the current working directory.</p>
<p>When using ‘ls’, you will note that different colors are used to depict the contents of your working directory.  These vary by the operating system you use; the following information corresponds to a default OSX terminal accessing Brown’s compute cluster (the most common system configuration among our affiliates).  The most commonly-used colors are described below:</p>
<p>Dark blue: a directory / folder</p>
<p>Light blue: a symbolic link (analogous to a shortcut on Windows)</p>
<p>Black: a miscellaneous file</p>
<p>Other colors have niche uses that you are unlikely to encounter at this stage</p>
<p><strong>Changing Command Behavior</strong></p>
<p>Many Linux commands have options that change their behavior, and ‘ls’ is no exception.  These options are set using a minus (-), directly followed by the letter associated with that option.</p>
<p>For example, by default, ls only shows non-hidden files.  To show all files, you would type:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ls -a

[aleith@login002 ~]$ ls -a
.                        .fonts.conf                profile_backup
..                       .gconf                     .pulse
4-1                      .gconfd                    .pulse-cookie
</pre></div>
</div>
<p>Below, you can see the radically different output of ls -a relative to ls, specifically the inclusion of the great number of hidden files that exist on any Linux system.  Note that on Linux (and OSX), hidden files and directories always begin with a ‘.’ - all files that begin with a ‘.’ are hidden, and all hidden files begin with a ‘.’.</p>
<p>The third fundamental navigation command is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd

[aleith@login002 ~]$ cd anaconda
[aleith@login002 anaconda]$ pwd
/users/aleith/anaconda
</pre></div>
</div>
<p>This command stands for ‘change directory’ and is what allows you to actually move around among the various folders on your system.</p>
<p><strong>Tab Completion</strong></p>
<p>Some directories can have long, complicated names, making it difficult to type them out.  Fortunately, the CLI allows so-called ‘tab completion’ - when typing part of a directory’s path (or a file’s path), pressing ‘tab’ will cause the rest of the name to be automatically filled in.</p>
<p>If more than one item matches what you’ve typed, it will autocomplete up to the point of ambiguity and then you will need to type more and type ‘tab’ again.  For example, if you have two directories entitled <code class="docutils literal"><span class="pre">directory1</span></code> and <code class="docutils literal"><span class="pre">directory2</span></code> and type <code class="docutils literal"><span class="pre">dir</span></code> and then press ‘tab’, Linux will fill in <code class="docutils literal"><span class="pre">ectory</span></code> and then prompt you to complete the directory name, making a noise to inform you that further typing must be done.  Pressing ‘tab’ several times in rapid succession will display all directories that match what has been filled in so far (sounding the alert noise each time).</p>
<p><strong>Basic File Structure Overview</strong></p>
<p>There are two fundamental ways to refer to a file or directory on Linux: a relative file path or an absolute file path.</p>
<p>A relative file path is the location of a file with respect to your current working directory (and will therefore change based on where your working directory is).</p>
<p>An absolute file path, sometimes described as a ‘full file path’, is that file’s true location on the computer and is invariant.</p>
<p>There are several pieces of shorthand notation that are often used in defining a relative file path</p>
<p>. stands for the current working directory (i.e. the output of pwd)</p>
<p>.. stands for the parent directory, i.e. the directory that contains the current working directory</p>
<p>~ (‘tilde’) stands for the current user’s (i.e. your) home directory, the location of which is dependent on the system configuration</p>
<p>The absolute file path of a file is its location with respect to the ‘root directory’; the root directory is the highest level directory on the computer, and is denoted by the absolute path ‘/’.  File paths beginning with ‘/’ are, by definition, absolute paths.</p>
<p>The following two paths are very different:</p>
<p>anaconda/bin/ is the ‘bin’ directory inside the ‘anaconda’ directory inside the <em>current</em> directory</p>
<p>/anaconda/bin/ is the ‘bin’ directory inside the ‘anaconda’ directory inside the <em>root</em> directory</p>
<p>The only time these two paths will point to the same place is when the root directory is the current working directory.  As a result, to avoid ambiguity, it is generally a good idea to stick to absolute file paths whenever possible - otherwise, it’s possible to misplace a file or direct a script to look in the wrong place for data.</p>
<p><strong>File Manipulation</strong></p>
<p>We will now cover the basic tenets of file manipulation using the CLI.  First, however, we must briefly address a technical topic that is likely unfamiliar: file permissions.</p>
<p>If you’ve ever had to type your administrator password on Windows or OSX to perform an operation, you’ve encountered file permissions before…these operating systems just make the process more opaque, increasing ease of use at the cost of flexibility as alluded to earlier.</p>
<p><em>File Permissions</em></p>
<p>There are three fundamental permissions: read (r), write (w), and execute (x).</p>
<p>There are also three <em>sets</em> of permissions: those belonging to the user (u), those belonging to the user’s group (g), and those belonging to everyone else (o) on the system.</p>
<p>To view a file’s permissions on Linux, you can type:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ls -lh

[aleith@login002 linux_tutorial]$ ls -lh
total 0
-rw-r--r-- 1 aleith cbc    0 Mar 19 18:43 randomfile.txt
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">-rw-r--r--</span></code> means ‘user has read and write permission’, ‘user’s group has read permission’, and ‘everyone else has read permission’.</p>
<p><code class="docutils literal"><span class="pre">aleith</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">cbc</span></code> means this file is owned by user ‘aleith’ from group ‘cbc’.</p>
<p><code class="docutils literal"><span class="pre">0</span></code> refers to the file’s rounded file size.</p>
<p>The last-modified date is also included for each file.</p>
<p>A file’s permissions can be changed by the owner using the command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chmod</span> <span class="p">[</span><span class="n">permission</span> <span class="n">to</span> <span class="n">change</span><span class="p">]</span> <span class="p">[</span><span class="n">target</span><span class="p">]</span>
</pre></div>
</div>
<p>For example, user ‘aleith’ can give himself execute permission (‘u+x’ - add execute permission to user) on ‘randomfile.txt’ using the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[aleith@login002 linux_tutorial]$ chmod u+x randomfile.txt
[aleith@login002 linux_tutorial]$ ls -lh
total 0
-rwxr--r-- 1 aleith cbc    0 Mar 19 18:43 randomfile.txt
</pre></div>
</div>
<p>Note that a file for which you have execute permissions will be colored green within the standard OSX terminal / CentOS 6.7 environment.</p>
<p>Execute permission is largely irrelevant for a text file, but it is vitally important for any script that is to be run; newly-created files often do not start with execute permission even when you create them yourself.  To run a script by typing its name into the terminal, you must first grand that script execute permission, which is a safeguard to protect against the accidental execution of malicious code.</p>
<p>The command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chown</span> <span class="p">[</span><span class="n">new</span> <span class="n">owner</span><span class="p">]</span> <span class="p">[</span><span class="n">file</span><span class="p">]</span>
</pre></div>
</div>
<p>will transfer ownership of a file to the user specified as ‘new owner’.</p>
<p>The command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chgrp</span> <span class="p">[</span><span class="n">new</span> <span class="n">group</span><span class="p">]</span> <span class="p">[</span><span class="n">file</span><span class="p">]</span>
</pre></div>
</div>
<p>will transfer the file to another group without changing the user.  As users can each be members of multiple groups, this command is often used to transfer a file from one of your own groups to another.</p>
<p><em>Interacting with Files</em></p>
<p>To create a new empty directory from the command line, simply type:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="p">[</span><span class="n">directory</span> <span class="n">name</span><span class="p">]</span>
</pre></div>
</div>
<p>This command, naturally, means ‘make directory’.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[aleith@login002 linux_tutorial]$ mkdir directory1
[aleith@login002 linux_tutorial]$ ls
directory1  randomfile.txt
</pre></div>
</div>
<p>Directories created in this manner cannot contain spaces, as the CLI will interpret any space as the end of the directory’s name.  Likewise, attempting to navigate to a directory with spaces will cause problems, as the navigation commands discussed earlier will interpret spaces in the same manner (to get around this limitation in a pinch, you can force Linux to interpret a space as part of a directory name by prepending a ‘’ to that space in a process called “[escaping](<a class="reference external" href="https://en.wikipedia.org/wiki/Escape_character">https://en.wikipedia.org/wiki/Escape_character</a>)” the space; these names should never be used in the first place, though, and if present should immediately be changed to spaceless names using <code class="docutils literal"><span class="pre">mv</span></code> discussed below).</p>
<p>To move a file, one can use the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mv</span> <span class="p">[</span><span class="n">target</span><span class="p">]</span> <span class="p">[</span><span class="n">destination</span><span class="p">]</span>
</pre></div>
</div>
<p>The ‘move’ command moves ‘target’ to the directory specified as ‘destination’:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[aleith@login002 linux_tutorial]$ mv randomfile.txt ~/linux_tutorial/directory1/
[aleith@login002 linux_tutorial]$ ls
directory1
[aleith@login002 linux_tutorial]$ ls ~/linux_tutorial/directory1/
randomfile.txt
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">mv</span></code> is also the command used to rename files in Linux - if the target and destination are both in the same directory, Linux will interpret that command as a rename request i.e. <code class="docutils literal"><span class="pre">mv</span> <span class="pre">old_name</span> <span class="pre">new_name</span></code>.</p>
<p>Files can be copied by typing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cp [original filename] [copy filename]

[aleith@login002 linux_tutorial]$ cd directory1/
[aleith@login002 directory1]$ cp randomfile.txt copiedfile.txt
[aleith@login002 directory1]$ ls
copiedfile.txt  randomfile.txt
</pre></div>
</div>
<p>The ‘copy’ command simply duplicates a file in its entirety.</p>
<p><em>Wildcard</em></p>
<p>The * character is known as the ‘wildcard’, and it is used to mean ‘any number of any characters’.</p>
<p>For example,:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[aleith@login002 directory1]$ touch script.sh  #create an empty script to serve as a contrast
[aleith@login002 directory1]$ ls
copiedfile.txt  script.sh   randomfile.txt
[aleith@login002 directory1]$ ls *.txt
copiedfile.txt  randomfile.txt
</pre></div>
</div>
<p>will run ‘ls’ on every file that ends in ‘.txt’, thus listing every plain textfile.  To illustrate this effect, a new file called ‘script.sh’ has been added to our directory using <code class="docutils literal"><span class="pre">touch</span></code>, which just generates an empty file with a designated name, in this case ‘script.sh’.  Note that <code class="docutils literal"><span class="pre">ls</span> <span class="pre">*.txt</span></code> does not print out this new file because it does not contain the characters ‘.txt’ anywhere.</p>
<p>Next, we show two more examples of how wildcards are interpreted.</p>
<p>First, we list any files beginning with ‘random’ and ending with anything:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ls random*

[aleith@login002 directory1]$ ls random*
randomfile.txt
</pre></div>
</div>
<p>Then, we list any files that start with anything, have a ‘d’ in the middle, and then end with anything:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ls *d*
[aleith@login002 directory1]$ ls *d*
copiedfile.txt  randomfile.txt
</pre></div>
</div>
<p><strong>Viewing Files</strong></p>
<p>To view the contents of a file, the <code class="docutils literal"><span class="pre">less</span></code> command can be used - it will display the first few lines of the file and allow you to scroll through it.  Pressing ‘q’ will close this browser.  <code class="docutils literal"><span class="pre">less</span></code> is so named because it is a more modern, scrollable version of the old UNIX command <code class="docutils literal"><span class="pre">more</span></code> (which is still available but obsolete):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">less</span> <span class="p">[</span><span class="n">file</span><span class="p">]</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">cat</span></code> command will print out the entirely of a file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="p">[</span><span class="n">file</span><span class="p">]</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">echo</span></code> command prints text to the screen:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="p">[</span><span class="n">text</span><span class="p">]</span>
</pre></div>
</div>
<p>e.g.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="s2">&quot;hello world&quot;</span>
</pre></div>
</div>
<p><strong>Redirecting Output</strong></p>
<p>By default, many tools (e.g. <code class="docutils literal"><span class="pre">echo</span></code>) will print their output to the terminal.  Naturally, the CLI has operators that can change this behavior by redirecting that output to various places depending on the user’s needs.</p>
<p>The:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">command</span><span class="p">]</span> <span class="o">&gt;</span> <span class="p">[</span><span class="n">file</span><span class="p">]</span>
</pre></div>
</div>
<p>operator redirects output to ‘file’, overwriting it if it already exists and creating it anew if not.</p>
<p>The related:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">command</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="p">[</span><span class="n">file</span><span class="p">]</span>
</pre></div>
</div>
<p>operator appends output to ‘file’.</p>
<p>Here is an example that compares these two operators:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[aleith@login002 directory1]$ echo &quot;hello world&quot;
hello world
[aleith@login002 directory1]$ echo &quot;hello world, redirected&quot; &gt; hello.txt
[aleith@login002 directory1]$ ls
copiedfile.txt script.sh
hello.txt      randomfile.txt
[aleith@login002 directory1]$ cat hello.txt
hello world, redirected
[aleith@login002 directory1]$ echo &quot;hello world, appended&quot; &gt;&gt; hello.txt
[aleith@login002 directory1]$ cat hello.txt
hello world, redirected
hello world, appended
</pre></div>
</div>
<p><strong>Downloading Files</strong></p>
<p>Linux has two primary commands for downloading files.  The simplest and most user-friendly is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="p">[</span><span class="n">url</span><span class="p">]</span>
</pre></div>
</div>
<p>It downloads a file as-is, with the same filename, and places it in your current working directory.  The more flexibile alternative is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="p">[</span><span class="n">url</span><span class="p">]</span> <span class="o">&gt;</span> <span class="p">[</span><span class="n">filepath</span><span class="p">]</span>
</pre></div>
</div>
<p>Without the ‘&gt; [filepath]’ portion of the command, the contents of the file at ‘url’ will be printed to the terminal and not saved, a small portion of which is reproduced (the full output being hundreds of lines of HTML):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[aleith@login002 directory1]$ curl www.google.com
&lt;!doctype html&gt;&lt;html itemscope=&quot;&quot; itemtype=&quot;http://schema.org/WebPage&quot; lang=&quot;en&quot;&gt;&lt;head&gt;
&lt;meta content=&quot;Search the world&#39;s information, including webpages,
</pre></div>
</div>
<p>Juducious use of <code class="docutils literal"><span class="pre">&gt;</span></code> allows you to download the page to a file instead, and even invokes a progress meter:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[aleith@login002 directory1]$ curl www.google.com &gt; google.html
% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                         Dload  Upload   Total   Spent    Left  Speed
100 11371    0 11371    0     0   187k      0 --:--:-- --:--:-- --:--:--  236k
[aleith@login002 directory1]$ ls
copiedfile.txt  script.sh    google.html
hello.txt      randomfile.txt
</pre></div>
</div>
<p><strong>Parsing Files</strong></p>
<p>For the next few examples, we will use a (highly abridged) dictionary of English words:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[aleith@login002 directory1]$ mkdir grep_examples
[aleith@login002 directory1]$ cd grep_examples/
[aleith@login002 grep_examples]$ curl http://www-personal.umich.edu/~jlawler/wordlist &gt; dictionary.txt
 % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                         Dload  Upload   Total   Spent    Left  Speed
100  718k  100  718k    0     0  1117k      0 --:--:-- --:--:-- --:--:-- 1240k
</pre></div>
</div>
<p>The wc -l command uses the ‘word count’ function to count the number of lines this file comprises (69905):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[aleith@login002 grep_examples]$ wc -l dictionary.txt
69905 dictionary.txt
</pre></div>
</div>
<p>The grep command allows us to search through a file for any entries that match a specified pattern:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">grep</span> <span class="p">[</span><span class="n">pattern</span><span class="p">]</span> <span class="p">[</span><span class="n">filename</span><span class="p">]</span>
</pre></div>
</div>
<p>For example, we can search our dictionary for all words containing the letter sequence ‘aar’.  Note that by default, the pattern supplied to <code class="docutils literal"><span class="pre">grep</span></code> functions as though it has a wildcard on either side of the provided text:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[aleith@login002 grep_examples]$ grep &quot;aar&quot; dictionary.txt
aardvark
aardwolf
bazaar
tumultuaary
zaar
</pre></div>
</div>
<p>The previous example included a fairly specific pattern, ‘aar’, intentionally selected so all matches could fit on screen - but what if that weren’t the case?  How can we count the number of matches if there are hundreds or thousands of them?</p>
<p>As we’ve already seen, the CLI has operators for redirecting the output of commands to files.  As it turns out, it also has an operator that allows us to send the output of one function to <em>another function</em> (‘&gt;’ redirects to files, not other functions):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">|</span>
</pre></div>
</div>
<p>This vertical line operator is pronounced ‘pipe’.</p>
<p>If we want to know how many words in our dictionary contain the letter ‘a’ anywhere, we can combine <code class="docutils literal"><span class="pre">grep</span></code> and <code class="docutils literal"><span class="pre">wc</span> <span class="pre">-l</span></code> using a pipe, which would be formally stated as “piping the output of <code class="docutils literal"><span class="pre">grep</span></code> to <code class="docutils literal"><span class="pre">wc</span> <span class="pre">-l</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[aleith@login002 grep_examples]$ grep &quot;a&quot; dictionary.txt | wc -l
40387
</pre></div>
</div>
<p>If we tried to do so using the wrong operator, we would end up with weird behavior and a file named ‘wc’, since ‘&gt;’ treats its antecedent as a file name specification:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[aleith@login002 grep_examples]$ grep &quot;a&quot; dictionary.txt &gt; wc -l
[aleith@login002 grep_examples]$ ls
dictionary.txt  wc
</pre></div>
</div>
<p><strong>Deleting Files</strong></p>
<p>This ‘wc’ file is not useful, merely containing “dictionary.txt” as text:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[aleith@login002 grep_examples]$ cat wc
dictionary.txt
</pre></div>
</div>
<p>To delete a file, we use the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rm</span> <span class="p">[</span><span class="n">filename</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>!!!!!The ‘remove’ command permanently deletes a file.  Linux has no ‘Trash’ feature like Windows and OSX do - ``rm`` is in fact directly analogous to the ‘Empty Trash’ option on those systems!!!!!</strong></p>
<p><strong>Miscellanea</strong></p>
<p>Sometimes, it will be necessary to stop a command before it completes (e.g. upon making a typo with a wildcard and copying thousands of large files instead of a few).  To interrupt a command, type CTRL+c (this combination is valid on both Windows and OSX - do not substitute COMMAND for CTRL on OSX or it will not work).</p>
<p>One of the most important resources for understanding Linux commands is the manual associated with each command.  On most versions of Linux, you can access the manual for a function by typing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">function</span><span class="p">]</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
<p>e.g.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
<p>to bring up the manual for ‘copy’.</p>
<p>Note that this syntax will not necessarily hold for other UNIX-like operating systems such as OSX; when in doubt, Googling the name of the command and the operating system in use will reveal a web-based copy of that version’s manual.  Specifying the operating system is important since most OSes based on UNIX have a great many commands that share names but exhibit subtle differences in function or syntax.</p>
<p><em>Errors</em></p>
<p>The most common error encountered on a Linux system - hands down - is <code class="docutils literal"><span class="pre">command</span> <span class="pre">not</span> <span class="pre">found</span></code>.  This error means that the computer does not know how to process what you’ve typed - it could be due to a simple typo, or there could be a bigger issue.</p>
<p>A slapdash attempt to look at the cp manual will look like this, invoking the nonexistant command <code class="docutils literal"><span class="pre">cp</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[aleith@login002 grep_examples]$ cpr --help
bash: cpr: command not found
</pre></div>
</div>
<p>Oftentimes, however, you have indeed typed a valid command but Linux still says ‘command not found’ - how is that possible?:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[aleith@login002 grep_examples]$ samtools --help
bash: samtools: command not found
</pre></div>
</div>
<p>It all comes down to how a command line-based system runs software.  Unlike a GUI-based system where every program icon is linked directly to the software, Linux works based on a list of locations to look for program files (‘binaries’) - this list is called the ‘PATH’.</p>
<p>To view your PATH, you can type:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>echo $PATH

[aleith@login002 grep_examples]$ echo $PATH
/gpfs/runtime/opt/matlab/R2014a/bin:/gpfs/runtime/opt/perl/5.18.2/bin:/gpfs/runtime/opt/python/2.7.3/bin:/gpfs/runtime/opt/java/7u5/bin:/gpfs/runtime/opt/intel/2013.1.106/bin:/gpfs/runtime/opt/centos-updates/6.3/bin:/usr/lib64/qt-3.3/bin:/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin:/opt/ibutils/bin:/gpfs/runtime/bin:/users/aleith/bin
</pre></div>
</div>
<p>Here, the ‘$’ basically means ‘bash variable’ - PATH is a globally-defined variable on every Linux system.</p>
<p>Any ‘binary’ i.e. program that is somewhere other than one of the directories listed inside of PATH must be called by its full file path, and on some systems, that is not possible due to permissions and access control.  Thus, it is important to be sure that your PATH contains the necessary directories.</p>
<p>The contents of $PATH can be modified by editing a certain hidden file in your home directory; however, doing so incorrectly will cause severe problems for your account and make it impossible to run even the basic commands like <code class="docutils literal"><span class="pre">cd</span></code> so we will not cover that topic today.  Please contact our office using the contact information on this site’s homepage to set up a meeting to discuss the process.</p>
<p>Brown’s compute cluster has functionality that will temporarily modify your path in response to something called a <code class="docutils literal"><span class="pre">module</span> <span class="pre">load</span></code> command, which we will cover in the second half of this talk.  Please use that functionality rather than trying to permanently edit your PATH whenever possible.</p>
<p>Another common error is <code class="docutils literal"><span class="pre">Permission</span> <span class="pre">denied</span></code>, which occurs when you lack the permissions to perform a given operation.  This error usually comes about when you have downloaded a file and it’s been created with weird permissions.  To resolve this issue, simply add the requisite permission for the operation you are attempting.</p>
<p>We will simulate an example of this error below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[aleith@login002 grep_examples]$ cd ~/linux_tutorial/directory1/
[aleith@login002 directory1]$ chmod 000 randomfile.txt
[aleith@login002 directory1]$ ls -lh randomfile.txt
---------- 1 aleith cbc 0 Mar 19 18:43 randomfile.txt
[aleith@login002 directory1]$ cat randomfile.txt
cat: randomfile.txt: Permission denied
[aleith@login002 directory1]$ chmod u+r randomfile.txt
[aleith@login002 directory1]$ cat randomfile.txt
</pre></div>
</div>
<p>Linux has an uncountable number of developers publishing software, and most of these packages have their own unique errors.  It is therefore highly likely that you will encounter unintelligible errors in the course of your work, especially if you are using software written in older compiled languages like Java or C.</p>
<p>When encountering such an error, it is advisable to Google the entirety of the error message except for the filename and file path of your data; appending the name of your operating system is also important in finding an applicable solution.  Numerous forums, mailing lists, and blogs discuss how to respond to (almost) any error you might encounter, but these are often specific to a certain OS, so finding the correct one requires care in the specification of your search terms.</p>
</div>
<div class="section" id="part-ii-brown-s-compute-cluster">
<h2>Part II: Brown’s Compute Cluster<a class="headerlink" href="#part-ii-brown-s-compute-cluster" title="Permalink to this headline">¶</a></h2>
<p>Brown has a compute cluster operated by CCV, the Center for Computation and Visualization.  CCV offers services to researchers affiliated with Brown.  Chief among their resources is ‘Oscar’, the compute cluster itself.</p>
<p>A compute cluster is a network of computers (‘nodes’), a subset of which can be temporarily allocated to a single job as a group.  These nodes become, for all intents and purposes, a virtual ‘supercomputer’, pooling resources for a designated task.  Users can specify their computational needs, which determines how many nodes are allocated for that task.  Once the task is finished, the nodes are released back into the pool and can be used by other users - that way, resource aren’t sitting idle and being wasted.</p>
<p>To connect to Oscar, you must first [contact CCV to obtain an account](<a class="reference external" href="https://web1.ccv.brown.edu/start/account">https://web1.ccv.brown.edu/start/account</a>).  Once you have one, run the command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ssh</span> <span class="p">[</span><span class="n">user</span><span class="p">]</span><span class="nd">@ssh</span><span class="o">.</span><span class="n">ccv</span><span class="o">.</span><span class="n">brown</span><span class="o">.</span><span class="n">edu</span>
</pre></div>
</div>
<p>The ‘secure shell’ command creates a sort of virtual link between your terminal and a terminal on the remote machine, meaning your terminal can interact with the remote machine as though it belonged to that machine.  Once you type the above login command, you will be prompted for your password.</p>
<p>If you plan to use Oscar to print any graphics to the screen, you must use a slightly different version of the ‘secure shell’ command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ssh</span> <span class="o">-</span><span class="n">Y</span> <span class="p">[</span><span class="n">user</span><span class="p">]</span><span class="nd">@ssh</span><span class="o">.</span><span class="n">ccv</span><span class="o">.</span><span class="n">brown</span><span class="o">.</span><span class="n">edu</span>
</pre></div>
</div>
<p>The ‘-Y’ option will enable graphics forwarding.  That setting is necessary to use any application with a GUI e.g. Firefox, RStudio, or the typical Matlab environment.  Without specifying ‘-Y’, attempts to display graphics will cause errors:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[aleith@login002 directory1]$ firefox
Error: no display specified
</pre></div>
</div>
<p>If left idle, ssh connections will time out.  The time out interval is based on the system.  Attempting to type into a terminal connected to a timed-out session will yield ~10 seconds of lag, and then an error message:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">packet_write_wait</span><span class="p">:</span> <span class="n">Connection</span> <span class="n">to</span> <span class="p">[</span><span class="n">ip</span><span class="p">]</span> <span class="n">port</span> <span class="mi">22</span><span class="p">:</span> <span class="n">Broken</span> <span class="n">pipe</span>
</pre></div>
</div>
<p>Batch jobs running in the background will not be affected by this disconnection, though any interactive jobs running in the foreground (e.g. copying files with <code class="docutils literal"><span class="pre">cp</span></code>) will be terminated partway though.  This behavior is especially problematic if doing something like downloading a file or moving it with <code class="docutils literal"><span class="pre">mv</span></code>, as the resulting file(s) will be corrupted.</p>
<p>CCV also provides a ‘VNC client’ to connect to Oscar:</p>
<p><a class="reference external" href="https://web1.ccv.brown.edu/technologies/vnc">https://web1.ccv.brown.edu/technologies/vnc</a></p>
<p>The VNC client resembles a typical remote desktop application and can be used for graphically-focused applications with no special options.  When logging into the VNC, you specify parameters and are stuck with them until you end that job, so be sure to allocate the maximum amount you think you will need from the outset.</p>
<p><strong>Transferring Files</strong></p>
<p>CCV hosts a Samba tutorial that is quite long and can be found here:</p>
<p><a class="reference external" href="https://web1.ccv.brown.edu/doc/cifs">https://web1.ccv.brown.edu/doc/cifs</a></p>
<p>File transfers will be interrupted if the internet connection on either end goes down.</p>
<p><strong>Batch Jobs</strong></p>
<p>The question then becomes: how does one actually use a compute cluster to run anything beyond thbe basic commands we have seen thus far?</p>
<p>To accomplish this task, the user must create a special type of script called a ‘batch script’, used for running so-called ‘batch jobs’.  The batch script is submitted to the ‘resource manager’, a utility that allocates nodes to users.</p>
<p>Oscar uses a resource manager called ‘Slurm’.  When a batch script is submitted to Slurm, it will put it in a queue based on the computational requirements requested and the user’s job priority.  The different priority levels and their attributes can be viewed here:</p>
<p><a class="reference external" href="https://web1.ccv.brown.edu/start/account">https://web1.ccv.brown.edu/start/account</a></p>
<p>and are too detailed to reproduce here.</p>
<p>Once a requested job gets to the front of Slurm’s queue, it is initialized.  This job is run in ‘batch mode’, and happens silently in the background, with no output printed to the terminal.  Instead, the batch script is used to specify where the output that would ordinarily appear on the terminal is written to.  This output is provisioned into two files, ‘standard out’ and ‘standard error’ (though these names are not entirely indicative - error messages sometimes go to ‘standard out’ depending on how the software is written).</p>
<p><em>Formatting</em></p>
<p>All batch scripts require a header that follows a specified format - otherwise, Slurm will be unable to allocate resources to it:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash                                             The typical shebang statement</span>
<span class="c1">#SBATCH --time=144:00:00                The time to request resources for</span>
<span class="c1">#SBATCH --cpus-per-task=8               The CPUs to request</span>
<span class="c1">#SBATCH  --mem=64G                              The memory to request</span>
<span class="c1">#SBATCH -J exac                                 The name under which to list the job</span>
<span class="c1">#SBATCH -o exac.out                             The file for ‘standard out’</span>
<span class="c1">#SBATCH -e exac.err                             The file for ‘standard error’</span>
</pre></div>
</div>
<p>Please note that the <code class="docutils literal"><span class="pre">#</span></code> symbols are part of the format and are not an example of commands being ‘commented out’.  They must be included for the script to be processed.  Other, optional parameters can be found at the following address:</p>
<p><a class="reference external" href="https://web1.ccv.brown.edu/doc/jobs">https://web1.ccv.brown.edu/doc/jobs</a></p>
<p>To submit a batch script with the aforementioned header, type:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sbatch</span> <span class="p">[</span><span class="n">script</span> <span class="n">name</span><span class="p">]</span>
</pre></div>
</div>
<p>You will receive a message stating that your job has been submitted.  To monitor its status, type:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">myq</span>
</pre></div>
</div>
<p>The ‘my queue’ command shows any pending or running jobs associated with your own user account.  It is useful to check if a job has failed - if you submit an alignment you expect to take days, and after 30 seconds no job is running, it broke.</p>
<p><em>Modules</em></p>
<p>The method for using software is, on the surface, different from that found on a local computer.  To use a given tool, you must first ‘load’ that tool as a ‘module’ as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">load</span> <span class="p">[</span><span class="n">software</span> <span class="n">name</span><span class="p">]</span>
</pre></div>
</div>
<p>e.g. <code class="docutils literal"><span class="pre">module</span> <span class="pre">load</span> <span class="pre">samtools</span></code></p>
<p>In truth, though, this command just temporarily prepends that software’s location to the beginning of your PATH (try viewing your PATH before and after loading!)</p>
<p>To see a list of all software available on Oscar, type:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">avail</span>
</pre></div>
</div>
<p>To see all of the modules currently loaded, type:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="nb">list</span>
</pre></div>
</div>
<p>To unload a loaded module, type:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">unload</span> <span class="p">[</span><span class="n">software</span> <span class="n">name</span><span class="p">]</span>
</pre></div>
</div>
<p>The terminal you see when first sshing into Oscar is running on a ‘login node’, a shared machine with low capabilities.  Computationally-intensive jobs run on the login node will immediately die.  It is possible, however, to access a node that works like a fully-capable terminal.</p>
<p>To access such a node, type:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">interact</span>
</pre></div>
</div>
<p>An example of an interact command is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">interact</span> <span class="o">-</span><span class="n">n</span> <span class="mi">20</span> <span class="o">-</span><span class="n">t</span> <span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span> <span class="o">-</span><span class="n">m</span> <span class="mi">10</span><span class="n">g</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">-n</span></code> refers to the number of cores (20)
<code class="docutils literal"><span class="pre">-t</span></code> refers to the time the session will last (1 hour)
<code class="docutils literal"><span class="pre">-m</span></code> refers to the memory per node (10 GB)</p>
<p>The full list of options can be found at the following link:</p>
<p><a class="reference external" href="https://web1.ccv.brown.edu/doc/jobs">https://web1.ccv.brown.edu/doc/jobs</a></p>
</div>
</div>

  <div class="section">
  
  
  </div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/brown_logo.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=compbiocore&repo=compbiocore&type=follow&count=true"
  allowtransparency="true" frameborder="0" scrolling="0" width="170px" height="20px"></iframe>
</p>





<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference external" href="https://compbiocore.github.io/cbc-workshops/">CBC Workshop index</a></li>
<li class="toctree-l1"><a class="reference internal" href="slides.html">CBC Linux Tutorial Presentation Slides</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Linux Explication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#part-i-introduction-to-linux">Part I: Introduction to Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="#part-ii-brown-s-compute-cluster">Part II: Brown’s Compute Cluster</a></li>
</ul>
</li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://compbiocore.github.io/tutorials">Tutorials</a></li>
    
    <li class="toctree-l1"><a href="https://compbiocore.github.io/workshops">Workshops</a></li>
    
    <li class="toctree-l1"><a href="https://compbiocore.github.io">Main Page</a></li>
    
    <li class="toctree-l1"><a href="https://compbiocore.github.io/software">Software</a></li>
    
</ul>



        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, August Guang.
      
      |
      <a href="_sources/linux_explication.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-115983496-2']);
      _gaq.push(['_setDomainName', 'none']);
      _gaq.push(['_setAllowLinker', true]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    
  </body>
</html>